{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended"
  ],
  "timezone": "UTC",
  "dependencyDashboard": true,
  "dependencyDashboardTitle": "Dependency Dashboard ðŸ¤–",
  "rebaseWhen": "conflicted",
  "commitMessagePrefix": "ðŸ”„ ",
  "commitMessageAction": "Update",
  "commitMessageTopic": "{{depName}}",
  "commitMessageExtra": "to {{newVersion}}",
  "prFooter": "This PR was generated by Renovate Bot ðŸ¤–",
  "prConcurrentLimit": 5,
  "branchConcurrentLimit": 10,
  "packageRules": [
    {
      "description": "Auto-merge rclone, kopia, and alpine updates with immediate scheduling",
      "matchDatasources": ["docker", "github-releases"],
      "matchPackageNames": [
        "alpine",
        "rclone/rclone",
        "kopia/kopia"
      ],
      "matchFileNames": ["proton-drive-backup/Dockerfile"],
      "automerge": true,
      "platformAutomerge": true,
      "schedule": ["at any time"],
      "stabilityDays": 0,
      "minimumReleaseAge": null,
      "labels": ["dependencies", "auto-merge", "container"],
      "reviewers": [],
      "assignees": [],
      "commitMessagePrefix": "ðŸ³ ",
      "prTitle": "ðŸ³ Update {{depName}} to {{newVersion}}",
      "prBodyTemplate": "This PR updates {{depName}} from {{currentVersion}} to {{newVersion}}.\n\n**Auto-merge**: âœ… Enabled\n**Build trigger**: âœ… Will trigger new container build\n\n{{#if (containsString updateType 'major')}}âš ï¸ **Major version update** - Please review breaking changes{{/if}}\n\n---\n{{> footer}}"
    },
    {
      "description": "GitHub Actions updates with stability period and manual review",
      "matchManagers": ["github-actions"],
      "automerge": false,
      "schedule": ["monthly"],
      "stabilityDays": 30,
      "minimumReleaseAge": "30 days",
      "labels": ["dependencies", "github-actions", "manual-review"],
      "reviewers": ["mnbf9rca"],
      "commitMessagePrefix": "âš™ï¸ ",
      "prTitle": "âš™ï¸ Update GitHub Action {{depName}} to {{newVersion}}",
      "prBodyTemplate": "This PR updates GitHub Action {{depName}} from {{currentVersion}} to {{newVersion}}.\n\n**Auto-merge**: âŒ Manual review required\n**Stability period**: âœ… {{stabilityDays}} days\n**Minimum age**: âœ… {{minimumReleaseAge}}\n\n{{#if (containsString updateType 'major')}}âš ï¸ **Major version update** - Please review breaking changes{{/if}}\n\n### ðŸ” Manual Review Required\nGitHub Actions updates require manual review to ensure CI/CD stability.\n\n---\n{{> footer}}"
    },
    {
      "description": "Disable updates for pinned GitHub Action SHAs unless explicitly enabled",
      "matchManagers": ["github-actions"],
      "matchCurrentVersion": "/^[a-f0-9]{40}$/",
      "enabled": false
    },
    {
      "description": "Enable SHA updates only for actions we want to keep current",
      "matchManagers": ["github-actions"],
      "matchCurrentVersion": "/^[a-f0-9]{40}$/",
      "matchPackageNames": [
        "actions/checkout",
        "docker/setup-buildx-action",
        "docker/metadata-action",
        "docker/build-push-action",
        "docker/login-action"
      ],
      "enabled": true,
      "schedule": ["monthly"],
      "stabilityDays": 30
    },
    {
      "description": "Group Docker multi-stage FROM updates",
      "matchDatasources": ["docker"],
      "matchFileNames": ["proton-drive-backup/Dockerfile"],
      "matchUpdateTypes": ["minor", "patch"],
      "groupName": "Docker base images",
      "automerge": true
    },
    {
      "description": "High priority security updates",
      "matchPackagePatterns": [".*"],
      "matchUpdateTypes": ["patch"],
      "labels": ["dependencies", "security", "patch"],
      "prPriority": 10,
      "schedule": ["at any time"]
    },
    {
      "description": "Kubernetes YAML dependency updates",
      "matchFileNames": ["**/*.yaml", "**/*.yml"],
      "excludeCommitPaths": [".github/workflows/**"],
      "enabled": true,
      "schedule": ["weekly"],
      "automerge": false,
      "labels": ["dependencies", "kubernetes"]
    }
  ],
  "regexManagers": [
    {
      "description": "Update rclone version and checksums in Dockerfile",
      "fileMatch": ["proton-drive-backup/Dockerfile"],
      "matchStrings": [
        "ARG RCLONE_VERSION=(?<currentValue>.*?)\\n.*?ARG RCLONE_AMD64_SHA256=(?<currentDigest>.*?)\\n.*?ARG RCLONE_ARM64_SHA256=(?<currentArm64Digest>.*?)\\n"
      ],
      "depNameTemplate": "rclone/rclone",
      "datasourceTemplate": "github-releases",
      "versioningTemplate": "semver"
    },
    {
      "description": "Update kopia version and checksums in Dockerfile",
      "fileMatch": ["proton-drive-backup/Dockerfile"],
      "matchStrings": [
        "ARG KOPIA_VERSION=(?<currentValue>.*?)\\n.*?ARG KOPIA_AMD64_SHA256=(?<currentDigest>.*?)\\n.*?ARG KOPIA_ARM64_SHA256=(?<currentArm64Digest>.*?)\\n"
      ],
      "depNameTemplate": "kopia/kopia",
      "datasourceTemplate": "github-releases",
      "versioningTemplate": "semver"
    }
  ],
  "vulnerabilityAlerts": {
    "enabled": true,
    "assignees": ["mnbf9rca"],
    "labels": ["security", "vulnerability"]
  },
  "osvVulnerabilityAlerts": true,
  "semanticCommits": "enabled",
  "separateMinorPatch": true,
  "separateMajorMinor": true,
  "separateMultipleMajor": true,
  "rangeStrategy": "pin"
}
