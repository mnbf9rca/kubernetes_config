{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended"
  ],
  "timezone": "UTC",
  "dependencyDashboard": true,
  "dependencyDashboardTitle": "Dependency Dashboard ü§ñ",
  "rebaseWhen": "conflicted",
  "commitMessagePrefix": "üîÑ ",
  "commitMessageAction": "Update",
  "commitMessageTopic": "{{depName}}",
  "commitMessageExtra": "to {{newVersion}}",
  "prFooter": "This PR was generated by Renovate Bot ü§ñ",
  "prConcurrentLimit": 5,
  "branchConcurrentLimit": 10,
  "packageRules": [
    {
      "description": "Auto-merge Cosign and Trivy security tool updates",
      "matchManagers": [
        "github-actions"
      ],
      "matchPackageNames": [
        "sigstore/cosign-installer",
        "aquasecurity/trivy-action"
      ],
      "automerge": true,
      "platformAutomerge": true,
      "schedule": [
        "at any time"
      ],
      "minimumReleaseAge": null,
      "labels": [
        "dependencies",
        "auto-merge",
        "security-tools"
      ],
      "reviewers": [],
      "assignees": [],
      "commitMessagePrefix": "üîê ",
      "prBodyTemplate": "This PR updates {{depName}} from {{currentVersion}} to {{newVersion}}.\n\n**Auto-merge**: ‚úÖ Enabled\n**Security tool**: ‚úÖ Cosign/Trivy version update\n\n---\nThis PR was generated by Renovate Bot ü§ñ"
    },
    {
      "description": "Auto-merge rclone, kopia, and alpine updates with immediate scheduling",
      "matchDatasources": [
        "docker",
        "github-releases"
      ],
      "matchPackageNames": [
        "alpine",
        "rclone/rclone",
        "kopia/kopia"
      ],
      "matchFileNames": [
        "proton-drive-backup/Dockerfile"
      ],
      "automerge": true,
      "platformAutomerge": true,
      "schedule": [
        "at any time"
      ],
      "minimumReleaseAge": null,
      "labels": [
        "dependencies",
        "auto-merge",
        "container"
      ],
      "reviewers": [],
      "assignees": [],
      "commitMessagePrefix": "üê≥ ",
      "prBodyTemplate": "This PR updates {{depName}} from {{currentVersion}} to {{newVersion}}.\n\n**Auto-merge**: ‚úÖ Enabled\n**Build trigger**: ‚úÖ Will trigger new container build\n\n---\nThis PR was generated by Renovate Bot ü§ñ"
    },
    {
      "description": "GitHub Actions updates with stability period and manual review",
      "matchManagers": [
        "github-actions"
      ],
      "automerge": false,
      "schedule": [
        "monthly"
      ],
      "minimumReleaseAge": "30 days",
      "labels": [
        "dependencies",
        "github-actions",
        "manual-review"
      ],
      "reviewers": [
        "mnbf9rca"
      ],
      "commitMessagePrefix": "‚öôÔ∏è ",
      "prBodyTemplate": "This PR updates GitHub Action {{depName}} from {{currentVersion}} to {{newVersion}}.\n\n**Auto-merge**: ‚ùå Manual review required\n**Stability period**: ‚úÖ 30 days\n**Minimum age**: ‚úÖ 30 days\n\n### üîç Manual Review Required\nGitHub Actions updates require manual review to ensure CI/CD stability.\n\n---\nThis PR was generated by Renovate Bot ü§ñ"
    },
    {
      "description": "Disable updates for pinned GitHub Action SHAs unless explicitly enabled",
      "matchManagers": [
        "github-actions"
      ],
      "matchCurrentVersion": "/^[a-f0-9]{40}$/",
      "enabled": false
    },
    {
      "description": "Group Docker multi-stage FROM updates",
      "matchDatasources": [
        "docker"
      ],
      "matchFileNames": [
        "proton-drive-backup/Dockerfile"
      ],
      "matchUpdateTypes": [
        "minor",
        "patch"
      ],
      "groupName": "Docker base images",
      "automerge": true
    },
    {
      "description": "High priority security updates",
      "matchUpdateTypes": [
        "patch"
      ],
      "labels": [
        "dependencies",
        "security",
        "patch"
      ],
      "prPriority": 10,
      "schedule": [
        "at any time"
      ]
    },
    {
      "description": "Kubernetes YAML dependency updates",
      "matchFileNames": [
        "**/*.yaml",
        "**/*.yml"
      ],
      "excludeCommitPaths": [
        ".github/workflows/**"
      ],
      "enabled": true,
      "schedule": [
        "before 6am on monday"
      ],
      "automerge": false,
      "labels": [
        "dependencies",
        "kubernetes"
      ]
    }
  ],
  "customManagers": [
    {
      "customType": "regex",
      "description": "Update Cosign version in GitHub Actions workflows",
      "fileMatch": [
        "^\\.github/workflows/.+\\.ya?ml$"
      ],
      "matchStrings": [
        "cosign-release: [\"']?(?<currentValue>v?[^\"'\\s]+)[\"']?"
      ],
      "depNameTemplate": "sigstore/cosign",
      "datasourceTemplate": "github-releases",
      "versioningTemplate": "semver"
    },
    {
      "customType": "regex",
      "description": "Update Trivy version in GitHub Actions workflows",
      "fileMatch": [
        "^\\.github/workflows/.+\\.ya?ml$"
      ],
      "matchStrings": [
        "uses: aquasecurity/trivy-action@[a-f0-9]+\\s*\\n.*?version: [\"']?(?<currentValue>v?[^\"'\\s]+)[\"']?"
      ],
      "depNameTemplate": "aquasecurity/trivy",
      "datasourceTemplate": "github-releases",
      "versioningTemplate": "semver"
    },
    {
      "customType": "regex",
      "description": "Update rclone version and checksums in Dockerfile",
      "managerFilePatterns": [
        "/proton-drive-backup/Dockerfile/"
      ],
      "matchStrings": [
        "ARG RCLONE_VERSION=(?<currentValue>.*?)\\n"
      ],
      "depNameTemplate": "rclone/rclone",
      "datasourceTemplate": "github-releases",
      "versioningTemplate": "semver"
    },
    {
      "customType": "regex",
      "description": "Update kopia version and checksums in Dockerfile",
      "managerFilePatterns": [
        "/proton-drive-backup/Dockerfile/"
      ],
      "matchStrings": [
        "ARG KOPIA_VERSION=(?<currentValue>.*?)\\n"
      ],
      "depNameTemplate": "kopia/kopia",
      "datasourceTemplate": "github-releases",
      "versioningTemplate": "semver"
    }
  ],
  "vulnerabilityAlerts": {
    "enabled": true,
    "assignees": [
      "mnbf9rca"
    ],
    "labels": [
      "security",
      "vulnerability"
    ]
  },
  "osvVulnerabilityAlerts": true,
  "semanticCommits": "enabled",
  "separateMinorPatch": true,
  "separateMajorMinor": true,
  "separateMultipleMajor": true,
  "rangeStrategy": "pin"
}
